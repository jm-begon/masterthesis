# -*- coding: utf-8 -*-
"""
Created on Tue May 20 12:01:41 2014

@author: Jm Begon
"""

# -*- coding: utf-8 -*-
"""
Created on Sun May 18 14:40:09 2014

@author: Jm Begon
"""
import pylab as pl
import numpy as np

from util import plotFeatureImportance, getCumulFreq


def plotAcc():
    sizes = [10, 30, 50, 100,  300,  500]

    legend = ["rci : moving window"]
    data = [0.492, 0.5151, 0.5213, 0.5262, 0.5287, 0.5291]
    pl.figure()
    pl.xticks(sizes, sizes, rotation=-45)
    pl.xlabel("Number of trees")
    pl.xlim(0, 600)
    pl.yticks(pl.arange(0.45, 0.55, 0.01))
    pl.ylim(0.45, 0.55)
    pl.ylabel("Accuracy")
    pl.plot(sizes, data, "-o")
    pl.title("Accuracy as a function of number of trees")
    pl.legend(legend, loc=4)
    for i,j in zip(sizes,data):
        pl.annotate(str(j),xy=(i+5,j+0.0005))
    pl.plot()


def plotFI(data, nbTest):
    plotFeatureImportance(data, "RandConv with original image (feature 0) : feature importances \nGlobal varibility test "+str(nbTest), None)


def plotFIHist(data, nbTest):
    indices = np.argsort(data)[::-1]
    data = np.array(data)[indices]
    plotFeatureImportance(data, "RandConv with original image (feature 0) : feature importance histogram\nGlobal varibility test "+str(nbTest), None)



if __name__ == "__main__":
    usual = [ 0.0271098, 0.0189606, 0.0001375, 0.0236002, 0.0107521, 0.0015851, 0.0081692, 0.0190917, 0.0116396, 0.0004176, 0.0011001, 0.0016647, 0.0194823, 0.0087727, 0.0004605, 0.0131183, 0.0000099, 0.0171307, 0.0104943, 0.0217925, 0.0061458, 0.0000000, 0.0103114, 0.0177175, 0.0099031, 0.0028929, 0.0154457, 0.0271596, 0.0000196, 0.0104398, 0.0222576, 0.0010369, 0.0170559, 0.0000103, 0.0127365, 0.0085806, 0.0273544, 0.0175444, 0.0000023, 0.0000069, 0.0001545, 0.0000285, 0.0000121, 0.0205825, 0.0146406, 0.0282398, 0.0054543, 0.0161403, 0.0038054, 0.0165724, 0.0247801, 0.0113244, 0.0164987, 0.0025082, 0.0000017, 0.0076390, 0.0272782, 0.0175415, 0.0113167, 0.0165124, 0.0100562, 0.0218732, 0.0000072, 0.0093629, 0.0014318, 0.0180456, 0.0173523, 0.0000178, 0.0020570, 0.0046616, 0.0025479, 0.0063238, 0.0046936, 0.0011504, 0.0063963, 0.0190344, 0.0018903, 0.0130071, 0.0000473, 0.0219228, 0.0196532, 0.0258176, 0.0218472, 0.0000175, 0.0001266, 0.0026593, 0.0045112, 0.0187227, 0.0156148, 0.0000059, 0.0095575, 0.0214169, 0.0060630, 0.0051031, 0.0010056, 0.0093537, 0.0011318, 0.0013847, 0.0053247, 0.0014987, 0.0041633, ]
    t1 = [ 0.0327621, 0.0206296, 0.0231417, 0.0089908, 0.0186711, 0.0093939, 0.0034100, 0.0000810, 0.0045790, 0.0003159, 0.0137489, 0.0235078, 0.0278388, 0.0048616, 0.0356566, 0.0007424, 0.0086907, 0.0008142, 0.0000037, 0.0163565, 0.0187038, 0.0243947, 0.0027693, 0.0023187, 0.0175993, 0.0046107, 0.0112097, 0.0150318, 0.0088174, 0.0181591, 0.0153828, 0.0223106, 0.0322781, 0.0022980, 0.0100587, 0.0072483, 0.0027064, 0.0007617, 0.0166643, 0.0010748, 0.0010273, 0.0053479, 0.0326692, 0.0323296, 0.0231506, 0.0001515, 0.0013855, 0.0004723, 0.0005558, 0.0000039, 0.0018788, 0.0012915, 0.0000000, 0.0000551, 0.0314446, 0.0292148, 0.0011174, 0.0142215, 0.0017236, 0.0031166, 0.0020650, 0.0106365, 0.0000119, 0.0085453, 0.0003764, 0.0033001, 0.0159625, 0.0000226, 0.0009579, 0.0019233, 0.0062292, 0.0015470, 0.0100269, 0.0122458, 0.0180175, 0.0209762, 0.0030529, 0.0129601, 0.0239583, 0.0000443, 0.0000301, 0.0139909, 0.0029067, 0.0054682, 0.0029818, 0.0000912, 0.0000287, 0.0122125, 0.0034893, 0.0046426, 0.0134003, 0.0009681, 0.0073404, 0.0161268, 0.0237627, 0.0021594, 0.0094907, 0.0054968, 0.0178063, 0.0000568, 0.0349381, ]
    t2 = [ 0.0294405, 0.0000074, 0.0213769, 0.0095885, 0.0015690, 0.0200837, 0.0127642, 0.0021367, 0.0207451, 0.0162051, 0.0001397, 0.0164807, 0.0129347, 0.0158797, 0.0211451, 0.0000495, 0.0009674, 0.0277453, 0.0220785, 0.0013723, 0.0050000, 0.0098604, 0.0001699, 0.0151878, 0.0163932, 0.0212362, 0.0001166, 0.0000000, 0.0030237, 0.0023458, 0.0017989, 0.0012430, 0.0000018, 0.0221920, 0.0014116, 0.0100834, 0.0007750, 0.0000081, 0.0284679, 0.0154082, 0.0247927, 0.0080005, 0.0251682, 0.0156885, 0.0181119, 0.0168385, 0.0010179, 0.0120380, 0.0003626, 0.0010085, 0.0001433, 0.0031875, 0.0026072, 0.0076483, 0.0109038, 0.0165785, 0.0085765, 0.0217124, 0.0205794, 0.0039640, 0.0253374, 0.0160663, 0.0251674, 0.0006114, 0.0000344, 0.0083527, 0.0082690, 0.0030063, 0.0120664, 0.0190236, 0.0021296, 0.0000606, 0.0100694, 0.0000985, 0.0195302, 0.0000203, 0.0000000, 0.0233727, 0.0131569, 0.0054446, 0.0018199, 0.0142071, 0.0000175, 0.0030419, 0.0000294, 0.0107734, 0.0006888, 0.0022067, 0.0210201, 0.0145463, 0.0117994, 0.0156334, 0.0236050, 0.0078820, 0.0282635, 0.0000334, 0.0021050, 0.0120096, 0.0106695, 0.0000056, 0.0014628, ]
    t3 = [ 0.0334652, 0.0290984, 0.0050947, 0.0069781, 0.0001023, 0.0173968, 0.0000079, 0.0152333, 0.0185527, 0.0188638, 0.0006308, 0.0173082, 0.0116788, 0.0136822, 0.0104904, 0.0199237, 0.0000000, 0.0027038, 0.0193410, 0.0056966, 0.0052021, 0.0219551, 0.0003795, 0.0024849, 0.0001020, 0.0088400, 0.0001336, 0.0200405, 0.0005824, 0.0004786, 0.0087359, 0.0043955, 0.0003127, 0.0003560, 0.0006880, 0.0138270, 0.0218501, 0.0044707, 0.0000000, 0.0002001, 0.0003257, 0.0000951, 0.0226000, 0.0000080, 0.0058629, 0.0120225, 0.0241764, 0.0012331, 0.0044981, 0.0000134, 0.0119973, 0.0180006, 0.0122746, 0.0119898, 0.0195718, 0.0044259, 0.0210285, 0.0074286, 0.0000031, 0.0019869, 0.0220610, 0.0227692, 0.0108790, 0.0193304, 0.0216142, 0.0000077, 0.0301252, 0.0027534, 0.0188075, 0.0080552, 0.0010559, 0.0001582, 0.0046746, 0.0000030, 0.0061810, 0.0249646, 0.0078697, 0.0151376, 0.0106560, 0.0198369, 0.0012358, 0.0106541, 0.0054604, 0.0325746, 0.0148514, 0.0155227, 0.0192586, 0.0013077, 0.0000554, 0.0000246, 0.0182136, 0.0019438, 0.0021588, 0.0177269, 0.0331750, 0.0013946, 0.0013776, 0.0000782, 0.0232681, 0.0032389, 0.0087130, ]
    t4 = [ 0.0301092, 0.0076931, 0.0174445, 0.0078480, 0.0198674, 0.0209499, 0.0003340, 0.0058488, 0.0169585, 0.0177145, 0.0073734, 0.0229425, 0.0159608, 0.0123386, 0.0000191, 0.0002861, 0.0205964, 0.0086558, 0.0000748, 0.0225228, 0.0184876, 0.0011096, 0.0001768, 0.0064699, 0.0000019, 0.0178587, 0.0193149, 0.0054278, 0.0174892, 0.0100095, 0.0097199, 0.0000965, 0.0088249, 0.0000149, 0.0147531, 0.0015839, 0.0007711, 0.0286819, 0.0180680, 0.0160398, 0.0055735, 0.0225276, 0.0131834, 0.0153486, 0.0101176, 0.0000424, 0.0032276, 0.0000979, 0.0089713, 0.0173596, 0.0000017, 0.0069957, 0.0196880, 0.0165590, 0.0005485, 0.0031001, 0.0023572, 0.0029839, 0.0002127, 0.0195153, 0.0179378, 0.0100286, 0.0205242, 0.0040129, 0.0027444, 0.0049899, 0.0187814, 0.0011708, 0.0247660, 0.0199681, 0.0135034, 0.0032147, 0.0000359, 0.0001617, 0.0000015, 0.0171231, 0.0168921, 0.0199978, 0.0000695, 0.0177344, 0.0044008, 0.0001212, 0.0158080, 0.0172933, 0.0010019, 0.0194194, 0.0005241, 0.0002144, 0.0053036, 0.0154809, 0.0004631, 0.0169531, 0.0001762, 0.0000983, 0.0001312, 0.0003248, 0.0031664, 0.0001272, 0.0156547, 0.0302064, 0.0206231, ]
    t5 = [ 0.0327796, 0.0001768, 0.0118053, 0.0000744, 0.0267792, 0.0258984, 0.0045538, 0.0164153, 0.0000069, 0.0235003, 0.0195244, 0.0007554, 0.0110903, 0.0042103, 0.0221303, 0.0032442, 0.0186542, 0.0075321, 0.0213199, 0.0003442, 0.0063038, 0.0000583, 0.0000003, 0.0209524, 0.0170207, 0.0200423, 0.0052628, 0.0189977, 0.0005507, 0.0011985, 0.0170190, 0.0090196, 0.0064089, 0.0000348, 0.0012770, 0.0000497, 0.0186358, 0.0130516, 0.0054209, 0.0230058, 0.0002255, 0.0024368, 0.0182922, 0.0000109, 0.0134931, 0.0034216, 0.0022616, 0.0110254, 0.0096285, 0.0000208, 0.0175998, 0.0015832, 0.0121160, 0.0051710, 0.0170372, 0.0210160, 0.0060388, 0.0051407, 0.0072872, 0.0023470, 0.0256560, 0.0020312, 0.0034687, 0.0204100, 0.0000074, 0.0001071, 0.0003711, 0.0002560, 0.0055446, 0.0000014, 0.0031726, 0.0076603, 0.0087490, 0.0179157, 0.0076594, 0.0189922, 0.0227439, 0.0172825, 0.0203392, 0.0001857, 0.0182672, 0.0243153, 0.0012797, 0.0021419, 0.0169906, 0.0071992, 0.0211836, 0.0019654, 0.0197188, 0.0000456, 0.0122316, 0.0037265, 0.0197819, 0.0020947, 0.0134702, 0.0137024, 0.0004797, 0.0188930, 0.0199109, 0.0023206, 0.0064683, ]
    t6 = [ 0.0328192, 0.0000162, 0.0000000, 0.0205055, 0.0010517, 0.0000003, 0.0181865, 0.0064756, 0.0022117, 0.0001378, 0.0020987, 0.0133829, 0.0001653, 0.0028567, 0.0258848, 0.0029010, 0.0001145, 0.0144010, 0.0030484, 0.0037526, 0.0181241, 0.0206085, 0.0218777, 0.0011795, 0.0227901, 0.0200222, 0.0193735, 0.0214514, 0.0002779, 0.0001071, 0.0031945, 0.0010239, 0.0015832, 0.0055839, 0.0014841, 0.0229047, 0.0030153, 0.0008908, 0.0118412, 0.0193382, 0.0093411, 0.0002686, 0.0000041, 0.0043802, 0.0041224, 0.0175515, 0.0013307, 0.0002745, 0.0091915, 0.0246439, 0.0003758, 0.0227945, 0.0111779, 0.0175543, 0.0000205, 0.0000840, 0.0201769, 0.0071613, 0.0222881, 0.0096364, 0.0109539, 0.0127562, 0.0280986, 0.0064150, 0.0161116, 0.0003182, 0.0006590, 0.0170023, 0.0063290, 0.0207728, 0.0214311, 0.0254398, 0.0340206, 0.0000262, 0.0084059, 0.0098547, 0.0001430, 0.0213732, 0.0003574, 0.0196660, 0.0008667, 0.0205489, 0.0000742, 0.0002274, 0.0180293, 0.0018641, 0.0019685, 0.0012130, 0.0249545, 0.0010144, 0.0001377, 0.0018851, 0.0214908, 0.0052449, 0.0095330, 0.0327336, 0.0171330, 0.0066602, 0.0005003, 0.0238996, 0.0008261, ]
    t7  = [ 0.0253439, 0.0139213, 0.0182176, 0.0168618, 0.0001973, 0.0176249, 0.0000143, 0.0080068, 0.0033587, 0.0148197, 0.0203563, 0.0001428, 0.0038726, 0.0000036, 0.0137441, 0.0018900, 0.0088896, 0.0032599, 0.0004890, 0.0074016, 0.0177672, 0.0066011, 0.0156306, 0.0000901, 0.0139537, 0.0081204, 0.0163764, 0.0009208, 0.0001103, 0.0008850, 0.0000142, 0.0000004, 0.0002928, 0.0134085, 0.0102989, 0.0000549, 0.0255537, 0.0027909, 0.0192480, 0.0109953, 0.0234356, 0.0158317, 0.0020065, 0.0057718, 0.0071534, 0.0155347, 0.0181842, 0.0272049, 0.0022969, 0.0155503, 0.0189430, 0.0123894, 0.0001199, 0.0000323, 0.0041062, 0.0050620, 0.0167378, 0.0215865, 0.0009897, 0.0266402, 0.0000000, 0.0150348, 0.0050886, 0.0171035, 0.0076015, 0.0001396, 0.0140118, 0.0174543, 0.0032445, 0.0055138, 0.0201418, 0.0133815, 0.0183637, 0.0107581, 0.0030568, 0.0165407, 0.0034706, 0.0137335, 0.0138512, 0.0168494, 0.0232178, 0.0114565, 0.0206342, 0.0076597, 0.0012201, 0.0097618, 0.0046694, 0.0024770, 0.0045426, 0.0187703, 0.0186445, 0.0023495, 0.0197462, 0.0008506, 0.0000689, 0.0137239, 0.0093438, 0.0019296, 0.0089550, 0.0142297, 0.0093032, ]
    t8 = [ 0.0240553, 0.0041456, 0.0087262, 0.0066786, 0.0004766, 0.0175053, 0.0241431, 0.0199893, 0.0000057, 0.0165096, 0.0080852, 0.0181808, 0.0050640, 0.0078160, 0.0115205, 0.0000969, 0.0007722, 0.0007187, 0.0146199, 0.0171164, 0.0184542, 0.0000056, 0.0055488, 0.0242925, 0.0000237, 0.0000260, 0.0051930, 0.0001518, 0.0000728, 0.0114980, 0.0000351, 0.0182320, 0.0046038, 0.0167474, 0.0200962, 0.0023580, 0.0002064, 0.0169880, 0.0093137, 0.0249682, 0.0178060, 0.0000811, 0.0000020, 0.0208692, 0.0000580, 0.0035430, 0.0173731, 0.0070604, 0.0186594, 0.0150812, 0.0148293, 0.0247627, 0.0177812, 0.0174275, 0.0000468, 0.0183964, 0.0065898, 0.0000225, 0.0163724, 0.0000159, 0.0256773, 0.0077829, 0.0017248, 0.0029000, 0.0000656, 0.0149626, 0.0005949, 0.0000316, 0.0012407, 0.0044655, 0.0002493, 0.0188393, 0.0081428, 0.0000007, 0.0057743, 0.0167160, 0.0231689, 0.0011918, 0.0200111, 0.0232226, 0.0105049, 0.0001102, 0.0182506, 0.0159787, 0.0065356, 0.0178784, 0.0241331, 0.0089387, 0.0000302, 0.0075883, 0.0107346, 0.0197452, 0.0041421, 0.0147649, 0.0010424, 0.0000000, 0.0161368, 0.0056364, 0.0159563, 0.0149744, 0.0083365, ]
    t9 = [ 0.0306774, 0.0280253, 0.0180546, 0.0166627, 0.0188198, 0.0170886, 0.0206301, 0.0204440, 0.0000006, 0.0008056, 0.0216706, 0.0004212, 0.0201777, 0.0127271, 0.0128560, 0.0223716, 0.0196597, 0.0029876, 0.0183454, 0.0022747, 0.0228676, 0.0192782, 0.0031940, 0.0002840, 0.0032051, 0.0246981, 0.0181457, 0.0005404, 0.0234416, 0.0055278, 0.0223227, 0.0060283, 0.0209760, 0.0049289, 0.0000015, 0.0092275, 0.0000108, 0.0112986, 0.0117662, 0.0036773, 0.0000027, 0.0000047, 0.0160939, 0.0057185, 0.0005844, 0.0004858, 0.0070657, 0.0000214, 0.0146114, 0.0000126, 0.0185708, 0.0187537, 0.0006246, 0.0002145, 0.0006180, 0.0060985, 0.0024567, 0.0171043, 0.0097870, 0.0034056, 0.0003876, 0.0106905, 0.0216777, 0.0000202, 0.0177508, 0.0115915, 0.0040464, 0.0059609, 0.0049723, 0.0016140, 0.0273042, 0.0262658, 0.0171176, 0.0195676, 0.0180274, 0.0027282, 0.0003785, 0.0008771, 0.0002629, 0.0019789, 0.0057740, 0.0000441, 0.0175432, 0.0016267, 0.0182228, 0.0180318, 0.0001774, 0.0009187, 0.0001560, 0.0003404, 0.0177764, 0.0136312, 0.0077836, 0.0015302, 0.0144836, 0.0227217, 0.0080447, 0.0175010, 0.0010949, 0.0000668, 0.0009551, ]
    t10 = [ 0.0337587, 0.0049137, 0.0230405, 0.0004900, 0.0082793, 0.0033819, 0.0205907, 0.0001274, 0.0101716, 0.0000537, 0.0147483, 0.0236076, 0.0202671, 0.0000316, 0.0238104, 0.0190257, 0.0058685, 0.0192716, 0.0149494, 0.0001089, 0.0048424, 0.0075114, 0.0226976, 0.0214111, 0.0248326, 0.0000288, 0.0013230, 0.0170462, 0.0196987, 0.0037636, 0.0073065, 0.0124228, 0.0018091, 0.0001057, 0.0000445, 0.0098302, 0.0009028, 0.0152320, 0.0161817, 0.0037123, 0.0000041, 0.0259695, 0.0001470, 0.0131714, 0.0004236, 0.0121409, 0.0141851, 0.0025172, 0.0001440, 0.0007240, 0.0207984, 0.0003382, 0.0057613, 0.0064627, 0.0000075, 0.0069718, 0.0226850, 0.0010131, 0.0099068, 0.0161651, 0.0002190, 0.0004468, 0.0006868, 0.0002284, 0.0181019, 0.0348175, 0.0006017, 0.0070557, 0.0024535, 0.0231797, 0.0190730, 0.0000156, 0.0016091, 0.0201419, 0.0197478, 0.0000651, 0.0188831, 0.0001170, 0.0056172, 0.0055288, 0.0136530, 0.0136576, 0.0097006, 0.0160984, 0.0052960, 0.0177528, 0.0192247, 0.0001780, 0.0258125, 0.0052222, 0.0085032, 0.0040518, 0.0000643, 0.0209313, 0.0197635, 0.0007295, 0.0051464, 0.0003594, 0.0000013, 0.0086411, 0.0298866, ]

    matrix = np.vstack([usual, t1, t2, t3, t4, t5, t6, t7, t8, t9, t10])
    corrMat = np.corrcoef(matrix)
    print corrMat



    pl.figure()
    pl.xlabel("features")
    pl.ylabel("Cumulative importance")
    pl.plot(getCumulFreq(usual), ".b")
    pl.plot(getCumulFreq(t1), "--r")
    pl.plot(getCumulFreq(t5), "*c")
    pl.plot(getCumulFreq(t6), "-g")
    pl.plot(getCumulFreq(t10), "+m")
    pl.ylim(0, 1.)
    pl.xlim(0, 80)
    legend = ["Test 0 (acc. : 0.5151)"]
    legend += ["Test 1 (acc. : 0.5183)"]
    legend += ["Test 5 (acc. : 0.5094)"]
    legend += ["Test 6 (acc. : 0.5093)"]
    legend += ["Test 10 (acc. : 0.5124)"]
    pl.legend(legend, loc=4)
    pl.title("Cumulative importance histogram")
    #pl.legend(legend, loc=4)



